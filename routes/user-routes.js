const express = require('express'),
      middleware = require("../middleware/index"),
      { check } = require ('express-validator'),
      userControllers = require('../controllers/user-controllers');

//Need the router method specifically so we can export and import into app.js
const router = express.Router();

//////////////////////////////////////////////////////////////////////////////////////
//HANDLE SHOWING OUR REGISTRATION PAGE
//
//Middleware 'alreadyLoggedIn' will check if the user has already logged in or not.
//If they have already logged in, then it will prevent access to registering.
//////////////////////////////////////////////////////////////////////////////////////
router.get('/register', middleware.alreadyLoggedIn, userControllers.showRegisterPage);


///////////////////////////////////////////////////////////////////////////////////////
//HANDLE OUR REGISTRATION LOGIC
//
///////////////////////////////////////////////////////////////////////////////////////
router.post('/register', userControllers.registerUser);


//////////////////////////////////////////////////////////////////////////////////////
//HANDLE SHOWING OUR SIGNIN PAGE
//
//Middleware 'alreadyLoggedIn' will check if the user has already logged in or not.
//If they have already logged in, then it will prevent access to logging in again.
//////////////////////////////////////////////////////////////////////////////////////
router.get('/login', middleware.alreadyLoggedIn, userControllers.showLogInPage);

///////////////////////////////////////////////////////////////////////////////////////
//HANDLE OUR LOGIN LOGIC
//
///////////////////////////////////////////////////////////////////////////////////////
router.post('/login', userControllers.logInUser);

///////////////////////////////////////////////////////////////////////////////////////
//HANDLE OUR LOGOUT LOGIC
//
///////////////////////////////////////////////////////////////////////////////////////
router.post('/logout', userControllers.logOutUser);

//////////////////////////////////////////////////////////////////////////////////////
//HANDLE SHOWING OUR USER PROFILE PAGE
//
//Middleware 'isLoggedIn' will ensure the user is logged in.
//Make sure they are logged in to properly see this page
//////////////////////////////////////////////////////////////////////////////////////
router.get('/profile/:id', middleware.isLoggedIn, userControllers.showUserProfilePage);

module.exports = router; 